!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):(e=e||self,r(e.jsonuri={}))}(this,function(e){"use strict";var r=function(){},t=Array.isArray,n=function(e){return"string"==typeof e},i=function(e){return Number.isInteger(e)},o=function(e){return i(e)&&e>=0},a=/\//,f=function(e){return a.test(e)},u=function(e){var r=typeof e;return null!=e&&("object"===r||"function"===r)},l=function(e){return e+""},p=function(e){console.error(e)},s=function(e,r,n){if(!t(e))return void(e[r]=n);if("length"===r){if(!o(n))throw new Error("value: "+n+" is not a natural number");return n>e.length&&(e.length=n),void e.splice(n)}var i=+r;if(!o(i))return void p("key: "+r+" is not a natural number");e.length=Math.max(e.length,i),e.splice(i,1,n)},c=function(e,r){if(t(e)){var n=+r;if(!o(n))return;e.splice(n,1)}else delete e[r]},h=function(e,r,t,n){if(void 0===n&&(n="after"),r<0||r>e.length)throw new Error("the Index Out of Bounds");switch(n){case"before":r-=1;break;case"append":p("TODO")}e.splice(r,0,t)},v=function(e){var r,t=e.path||"";for(e.keys?t||(r=e.keys):r=e.path.split("/"),r=r.filter(Boolean);~r.indexOf("");){n=r.indexOf("");r.splice(n,1)}for(;~r.indexOf(".");){var n=r.indexOf(".");r.splice(n,1)}for(;~r.indexOf("..");)r[n=r.indexOf("..")]=r[n-1]="",delete r[n],delete r[n-1],r.splice(n,1),r.splice(n-1,1);return{keys:r,path:r.join("/")}},d=function(e,r){if(null==e)return e;if(""===(r=l(r)))return e;if(!f(r))return e[r];var t,n=v({path:r}).keys;if(!n.length)return e;for(var i=n.length,o=0;o<i&&null!=(t=(o?t:e)[n[o]]);++o);return t},y=function(e,r,t){if(r=l(r),!e||!r)return p("the parameter is illegal");if(!f(r))return s(e,r,t);for(var n=v({path:r}).keys,i=0,o=n.length;i<o;i++){var a=n[i];null==e[a]&&(e[a]={}),i===o-1?s(e,a,t):e=e[a]}},g=function(e,r){if(r=l(r),e&&r){if(!f(r))return void c(e,r);var t=d(e,r+"/..");if(t){var n=v({path:r}).keys.pop()||"";c(t,n)}}},b=function(e,r,t){if(r=l(r),t=l(t),!(e&&r&&t&&n(r)&&n(t)))return p("the parameter is illegal");var i=d(e,r),o=d(e,t);y(e,t,i),y(e,r,o)},k=function(e,r,n,i){if(r=l(r),!e)return p("the parameter is illegal");if(!i)throw new Error("direction must be 'before' | 'after' | 'append'");var o=d(e,r+"/..");if(!t(o))throw new Error("insert node must be a Array");var a=+v({path:r}).keys.pop(),f=a;"after"===i?f=a+1:"before"===i&&(f=a),h(o,f,n)},m=Array.prototype,w=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=m.concat.apply(m,e).join("/").split("/");return v({keys:t}).path},x=function(e,r){var t=r.split("/"),n=e.split("/"),i=t.slice(0,t.length-1),o=n.slice(0,t.length-1);return!(t.length>n.length)&&i.join("/")===o.join("/")},O=function(e,r,i,o){if(r=l(r),i=l(i),!(e&&r&&i&&n(r)&&n(i)))return p("the parameter is illegal");if(r!==i){var a=d(e,i),f=d(e,r),s=d(e,i+"/.."),h=+(v({path:r}).keys.pop()||""),b=+(v({path:i}).keys.pop()||"");if(t(s)){if(!o)throw new Error("direction must be 'before' | 'after' | 'append'");return w()===w()?(k(e,i,f,o),void c(s,h+(b>h?0:1))):x(r,i)&&b<+(r.split("/").slice(0,i.split("/").length).pop()||"")?(g(e,r),void k(e,i,f,o)):(k(e,i,f,o),void g(e,r))}if(!u(a))throw new Error("'"+i+"': "+a+" is primitive values");y(e,i+"/"+r,f),g(e,r)}},j=function(e,r,n,i){if(void 0===i&&(i=1),r=l(r),!(o(i)&&i>0))return p("the parameter is illegal");if(!e)return p("the parameter is illegal");var a=d(e,r+"/..");if(!t(a))return p("must be a Array");var f=a.length,u=+v({path:r}).keys.pop();if(o(u)&&!(u>f-1)){var s=u+n*i;s<=0&&(s=0),s>f-1&&(s=f-1);var y=a[u];c(a,u),h(a,s,y)}},E=function(e,r,t){j(e,r,-1,t)},_=function(e,r,t){j(e,r,1,t)},A=function(e,r){var t=+v({path:e}).keys.pop();return i(t)?"prev"===r?w():"next"===r?w():null:null},P=function(e,r){if(void 0===r&&(r=[]),!u(e))return!1;r.push(e);for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];if(u(n)&&(~r.indexOf(n)||P(n,r.slice())))return!0}return!1},B=function(e,r){for(var t=!1,n=function(){t=!0},i=0,o=Object.keys(e);i<o.length;i++){var a=o[i];if(t)break;r(e[a],a,e,{_break:n})}},I=function(e,n,i){if(void 0===e&&(e={}),void 0===n&&(n=r),void 0===i&&(i=r),P(e))throw new Error("obj is a circular structure");var o=[],a=function(e){return B(e,function(e,r,f,l){var p=l._break,s=!1,c=function(){p(),s=!0,t(f)&&o.pop()};if(o.push(r),n(e,r,f,{path:w(),_break:c}),o.pop(),u(e)){if(o.push(r),s)return;a(e),o.pop(),i(e,r,f,{path:w(),_break:c})}}),e};return a(e)};e._computePath=A,e.down=_,e.get=d,e.insert=k,e.isCircular=P,e.mv=O,e.normalizePath=w,e.rm=g,e.set=y,e.swap=b,e.up=E,e.walk=I,Object.defineProperty(e,"__esModule",{value:!0})});
